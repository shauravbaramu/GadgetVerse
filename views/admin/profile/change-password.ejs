<%- include('../partials/header', { title: 'Change Password' }) %>
<%- include('../partials/topnav'), { activePage: 'admin/change-password' } %>
<%- include('../partials/sidebar', { activePage: 'admin/change-password' }) %>

<div class="content-wrapper">
  <!-- Content Header -->
  <section class="content-header">
    <div class="container-fluid">
      <div class="row mb-2">
        <div class="col-sm-6">
          <h1>Change Password</h1>
        </div>
      </div>
    </div>
  </section>

  <!-- Main Content -->
  <section class="content">
    <div class="container-fluid">
      <% if (typeof errors !== 'undefined' && errors.length > 0) { %>
        <% errors.forEach(function (error) { %>
          <div class="alert alert-danger"><%= error.msg %></div>
        <% }); %>
      <% } %>
      <% if (typeof success !== 'undefined' && success.length > 0) { %>
        <div class="alert alert-success"><%= success %></div>
      <% } %>
      <div class="row justify-content-center">
        <div class="col-md-8">
          <div class="card shadow-lg">
            <div class="card-header bg-primary text-white text-center">
              <h3 class="card-title">Change Password</h3>
            </div>
            <form action="/admin/change-password" method="POST">
              <div class="card-body">
                <!-- Old Password -->
                <div class="form-group position-relative">
                  <label for="old_password">Old Password</label>
                  <input type="password" name="old_password" id="old_password" class="form-control" placeholder="Enter your old password" required>
                  <span class="toggle-password" onclick="togglePassword('old_password')" style="position: absolute; top: 70%; right: 10px; transform: translateY(-50%); cursor: pointer;">
                    <i class="fas fa-eye"></i>
                  </span>
                </div>
                <!-- New Password -->
                <div class="form-group position-relative">
                  <label for="new_password">New Password</label>
                  <input type="password" name="new_password" id="new_password" class="form-control" placeholder="Enter your new password" required>
                  <span class="toggle-password" onclick="togglePassword('new_password')" style="position: absolute; top: 70%; right: 10px; transform: translateY(-50%); cursor: pointer;">
                    <i class="fas fa-eye"></i>
                  </span>
                </div>
                <!-- Confirm Password -->
                <div class="form-group position-relative">
                  <label for="confirm_password">Confirm Password</label>
                  <input type="password" name="confirm_password" id="confirm_password" class="form-control" placeholder="Confirm your new password" required>
                  <span class="toggle-password" onclick="togglePassword('confirm_password')" style="position: absolute; top: 70%; right: 10px; transform: translateY(-50%); cursor: pointer;">
                    <i class="fas fa-eye"></i>
                  </span>
                </div>
              </div>
              <div class="card-footer text-center">
                <button type="submit" class="btn btn-primary">
                  <i class="fas fa-save"></i> Change Password
                </button>
                <a href="javascript:history.back();" class="btn btn-secondary">
                  <i class="fas fa-arrow-left"></i> Back
                </a>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </section>
</div>

<%- include('../partials/footer') %>

<script>
  // Function to toggle password visibility
  function togglePassword(fieldId) {
    const field = document.getElementById(fieldId);
    const icon = field.nextElementSibling.querySelector('i');
    if (field.type === 'password') {
      field.type = 'text';
      icon.classList.remove('fa-eye');
      icon.classList.add('fa-eye-slash');
    } else {
      field.type = 'password';
      icon.classList.remove('fa-eye-slash');
      icon.classList.add('fa-eye');
    }
  }
</script>